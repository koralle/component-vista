---
title: "Better Auth 1.4"
source_url: "https://www.better-auth.com/blog/1-4"
fetched_at: "2025-12-17T17:03:49.997163+00:00"
---



# Better Auth 1.4

Stateless Auth, SCIM, Optimized database queries, additional state in OAuth flows, performance improvements, SSO domain verification, and more!

B

Bereket Engida¬∑[@bekacru](https://x.com/bekacru)¬∑Nov 21

[Blogs](https://www.better-auth.com/blog.html)

---

## [Better Auth 1.4 Release](https://www.better-auth.com/blog/1-4.html#better-auth-14-release)

We're excited to announce the release of Better Auth 1.4. This release includes several new features, performance and security improvements.

To upgrade, run:

npmpnpmyarnbun

```
npm install better-auth@1.4
```

---

## [üöÄ Highlights](https://www.better-auth.com/blog/1-4.html#-highlights)

### [Stateless Auth](https://www.better-auth.com/blog/1-4.html#stateless-auth)

You can now enable stateless session management without any database by omitting the `database` option in your auth config.

[üëâ Read more about stateless auth](https://www.better-auth.com/docs/concepts/session-management.html#stateless-session-management)

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
    // No database configuration
    socialProviders: {
        google: {
            clientId: process.env.GOOGLE_CLIENT_ID,
            clientSecret: process.env.GOOGLE_CLIENT_SECRET,
        },
    },
});
```

It also supports getting `accessToken`, `accountInfo` and `refreshToken` endpoints without any database.

```
import { authClient } from "@/lib/auth-client";

const accessToken = await authClient.getAccessToken();

// get account info
const accountInfo = await authClient.accountInfo();
```

---

### [SCIM Provisioning](https://www.better-auth.com/blog/1-4.html#scim-provisioning)

SCIM makes managing identities in multi-domain scenarios easier to support via a standardized protocol.

[üëâ Read more about SCIM provisioning](https://www.better-auth.com/docs/plugins/scim.html)

```
import { scim } from "@better-auth/scim";
import { betterAuth } from "better-auth";

export const auth = betterAuth({
    plugins: [scim()]
});
```

---

### [Custom State for OAuth Flows](https://www.better-auth.com/blog/1-4.html#custom-state-for-oauth-flows)

You can now provide any additional state through the OAuth flow.

[üëâ Read more about custom state for OAuth flows](https://www.better-auth.com/docs/concepts/oauth.html#passing-additional-data-through-oauth-flow)

```
import { authClient } from "@/lib/auth-client";

await authClient.signIn.social({
    provider: "google",
    additionalData: {
        referralCode: "ABC123",
        source: "landing-page",
    },
});
```

Access additional data in any hook, middleware, or endpoints

auth.ts

```
import { betterAuth } from "better-auth";
import { getOAuthState, createAuthMiddleware } from "better-auth/api";

const auth = betterAuth({
    hooks: {
      before: createAuthMiddleware(async (ctx) => {
        const additionalData = await getOAuthState<{ referralCode: string, source: string }>();
        console.log(additionalData);
      })
    }
});
```

---

### [Database Joins Improvements (experimental)](https://www.better-auth.com/blog/1-4.html#database-joins-improvements-experimental)

Better-Auth now supports database joins, improving over 50 endpoints by 2 to 3x in latency. This is achieved by using database joins under the hood.

To enable, simply set the `joins` flag to `true` under `experimental` in your auth config.
Then, re-run migrations or schema generation to get the updated schema which supports joins!

[üëâ Read more about database joins](https://www.better-auth.com/docs/concepts/database.html#experimental-joins)

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
    experimental: {
        joins: true,
    },
});
```

Although joins are experimental, they are supported by all adapters and will be enabled by default in the next release.

---

### [Secondary Storage Support for API Keys](https://www.better-auth.com/blog/1-4.html#secondary-storage-support-for-api-keys)

The API-Key plugin now supports secondary storage for faster key lookups!

[üëâ Read more about secondary storage for API keys](https://www.better-auth.com/docs/plugins/api-key.html#storage-modes)

```
import { apiKey } from "@better-auth/api-key";
import { betterAuth } from "better-auth";

export const auth = betterAuth({
    secondaryStorage: {
        //...
    },
    plugins: [apiKey({ storage: "secondary-storage" })],
});
```

### How To Migrate?

---

### [New Default Error Page](https://www.better-auth.com/blog/1-4.html#new-default-error-page)

We've revamped our error page to look much better and more informative!
You can also customize the stylings of our default error page or simply provide your own path to a custom error page.

[üëâ Read more about error page improvements](https://www.better-auth.com/docs/reference/options.html#onapierror)

![Error Page](https://www.better-auth.com/images/blogs/1-4_error.png)

---

### [SSO Domain Verification](https://www.better-auth.com/blog/1-4.html#sso-domain-verification)

Domain verification allows your application to automatically trust a new SSO provider
by automatically validating ownership via the associated domain:

üëâ [Read more about domain verification](https://www.better-auth.com/docs/plugins/sso.html#domain-verification)

```
import { sso } from "@better-auth/sso";
import { betterAuth } from "better-auth";

export const auth = betterAuth({
    plugins: [sso({ domainVerification: { enabled: true } })],
});
```

---

### [CLI Database Index Support](https://www.better-auth.com/blog/1-4.html#cli-database-index-support)

The Better-Auth CLI now supports indexing your database out of the box, which greatly improves the performance of your application.

```
npx @better-auth/cli generate

npx @better-auth/cli migrate
```

---

### [JWT Key Rotation Support](https://www.better-auth.com/blog/1-4.html#jwt-key-rotation-support)

The JWT plugin now supports key rotation, allowing you to rotate your JWT keys without downtime.

```
import { jwt } from "@better-auth/jwt";
import { betterAuth } from "better-auth";

export const auth = betterAuth({
    plugins: [
      jwt({
        jwks: { rotationInterval: 60 * 60 * 24 * 30, gracePeriod: 60 * 60 * 24 * 30 }
      })
    ],
});
```

üëâ [Read more about JWT key rotation](https://www.better-auth.com/docs/plugins/jwt.html#key-rotation)

### [Improved Generic OAuth Plugin](https://www.better-auth.com/blog/1-4.html#improved-generic-oauth-plugin)

OAuth providers not yet supported natively will be available as pre-configured options for the generic OAuth plugin,
with plans to eventually support all providers that Auth.js does.

```
import { betterAuth } from "better-auth";
import { genericOAuth } from "better-auth/plugins";
import { keycloak } from "better-auth/plugins/generic-oauth";

export const auth = betterAuth({
    plugins: [genericOAuth({
        config: [
            keycloak({
                clientId: process.env.KEYCLOAK_CLIENT_ID,
                clientSecret: process.env.KEYCLOAK_CLIENT_SECRET,
                issuer: process.env.KEYCLOAK_ISSUER,
            })
        ]
    })
    ]
});
```

---

### [Bundle Size Optimizations](https://www.better-auth.com/blog/1-4.html#bundle-size-optimizations)

If you're using custom adapters (like Prisma, Drizzle, or MongoDB),
you can reduce your bundle size by using `better-auth/minimal` instead of better-auth.
This version excludes Kysely, which is only needed when using direct database connections.

[üëâ Read more about bundle size optimizations](https://www.better-auth.com/docs/guides/optimizing-for-performance.html#bundle-size-optimization)

```
import { drizzleAdapter } from "better-auth/adapters/drizzle";
import { betterAuth } from "better-auth/minimal";
import { db } from "./database";

export const auth = betterAuth({
    database: drizzleAdapter(db, { provider: "pg" }),
});
```

---

### [UUID Support](https://www.better-auth.com/blog/1-4.html#uuid-support)

We now support having UUIDs as the primary ID field type out of the box.

[üëâ Read more about UUID support](https://www.better-auth.com/docs/concepts/database.html#uuids)

```
import { betterAuth } from "better-auth";
import { db } from "./database";

export const auth = betterAuth({
    database: db,
    advanced: {
        database: { generateId: "uuid" },
    },
});
```

---

### [Improved Email Change Flow](https://www.better-auth.com/blog/1-4.html#improved-email-change-flow)

For added security, you can now require users to confirm the change via their **current** email before
the verification email is sent to the new address.

[üëâ Read more about improved email change flow](https://www.better-auth.com/docs/concepts/users-accounts.html#confirming-with-current-email)

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
    user: {
        changeEmail: {
            enabled: true,
            sendChangeEmailConfirmation: async ({ user, newEmail, url, token }, request) => {
                sendEmail({
                    to: user.email, // Sent to the CURRENT email
                    subject: 'Approve email change',
                    text: `Click the link to approve the change to ${newEmail}: ${url}`
                })
            }
        }
    }
});
```

---

### [Device Authorization Plugin](https://www.better-auth.com/blog/1-4.html#device-authorization-plugin)

Full support for the OAuth 2.0 Device Authorization Grant (RFC 8628), allowing users to sign in on input-constrained devices like Smart TVs and gaming consoles.

[üëâ Read more about Device Authorization](https://www.better-auth.com/docs/plugins/device-authorization.html)

```
import { betterAuth } from "better-auth";
import { deviceAuthorization } from "better-auth/plugins";

export const auth = betterAuth({
    plugins: [
        deviceAuthorization()
    ]
});
```

---

### [Cookie-based Account Storage](https://www.better-auth.com/blog/1-4.html#cookie-based-account-storage)

You can now store user account data in a signed cookie, which is perfect for stateless applications or when you want to defer database persistence.

```
export const auth = betterAuth({
    account: {
        storeAccountCookie: true
    }
});
```

---

## [‚ö†Ô∏è Breaking Changes](https://www.better-auth.com/blog/1-4.html#Ô∏è-breaking-changes)

We recommend going through each breaking change to ensure a smooth upgrade.

### [Existing Auth Flows](https://www.better-auth.com/blog/1-4.html#existing-auth-flows)

Minor auth flow changes to make everything smoother, faster, and more reliable.

* **Change-Email Flow**: We've removed `sendChangeEmailVerification` from the `changeEmail` flow to use `emailVerification.sendVerificationEmail` instead.
* **Forgot Password Flow**: `authClient.forgotPassword` is now `authClient.requestPasswordReset`.
* **Account Info Endpoint**: The `accountInfo` endpoint has changed from `POST /account-info` to `GET /account-info`.

  This means any auth.api calls must change from:

  ```
  auth.api.accountInfo({
      body: {
          // ...
      }
  });
  ```

  to:

  ```
  auth.api.accountInfo({
      query: {
          // ...
      }
  });
  ```

### [Plugin Options Changes](https://www.better-auth.com/blog/1-4.html#plugin-options-changes)

Multiple plugin options that accept `request` as an argument for callback functions have now replaced request with `ctx` instead. Passkey plugin is now moved to its own package, and API Key mock-sessions are now disabled by default.

* **Passkey Plugin**: The passkey plugin is now moved to its own package.

  Install it today:

  npmpnpmyarnbun

  ```
  npm install @better-auth/passkey
  ```
* **Email OTP Plugin**: Plugin options for `sendVerificationOTP` and `generateOTP` now use `ctx` instead of `request` in its callback function. You can still access request via `ctx.request`.
* **Magic Link Plugin**: Plugin options for `sendMagicLink` now uses `ctx` instead of `request` for one of its callback options. You can still access request via `ctx.request`.
* **Phone Number Plugin**: Plugin options for `sendOTP`, `sendPasswordResetOTP` & `callbackOnVerification` have now replaced request with `ctx` in one of its callback options. You can still access request via `ctx.request`.
* **Organization Plugin**: Plugin options for `teams.defaultTeam.customCreateDefaultTeam` & `teams.maximumTeams` have now replaced request with `ctx` for one of its callback options. You can still access request via `ctx.request`.
* **OIDC Plugin**: The field `redirectURLs` have been updated to `redirectUrls`, this requires database migration.
* **API Key Plugin**: Mock-sessions by api-keys are now disabled by default, and should be enabled through the auth-config first.

### [Auth Config Changes](https://www.better-auth.com/blog/1-4.html#auth-config-changes)

Database configuration options changes.

* **`advanced.generateId` removed**: The long-deprecated `advanced.generateId` has been removed. Please use `advanced.database.generateId` instead.
* **`advanced.database.useNumberId` moved**: `advanced.database.useNumberId` has been moved to `advanced.database.generateId: "serial"` instead.

### [Tanstack Start](https://www.better-auth.com/blog/1-4.html#tanstack-start)

The Better-Auth offered `reactStartCookies` plugin is now moved to `tanstackStartCookies` plugin.

```
- import { reactStartCookies } from "better-auth/react-start";
+ import { tanstackStartCookies } from "better-auth/tanstack-start";

export const auth = betterAuth({
-    plugins: [reactStartCookies()],
+    plugins: [tanstackStartCookies()],
});
```

### [Expo](https://www.better-auth.com/blog/1-4.html#expo)

With the new pooling features for `useSession` on Expo, you're required to install `expo-network`:

npmpnpmyarnbun

```
npx expo install expo-network
```

### [Cloudflare Runtime](https://www.better-auth.com/blog/1-4.html#cloudflare-runtime)

Better Auth uses AsyncLocalStorage for async context tracking.
To enable this in Cloudflare Workers, add the `nodejs_compat` flag to your `wrangler.toml`:

wrangler.toml

```
compatibility_flags = ["nodejs_compat"]
compatibility_date = "2024-09-23"
```

Alternatively, if you only need AsyncLocalStorage support:

wrangler.toml

```
compatibility_flags = ["nodejs_als"]
```

In the next major release, we will assume AsyncLocalStorage support by default, so this configuration will be necessary.

---

## [‚ú® More Features](https://www.better-auth.com/blog/1-4.html#-more-features)

* **Cookie Chunking**: No more cookie size exceeding errors.
* **MongoDB String IDs**: Support for using String IDs instead of ObjectIDs in MongoDB.
* **JWE Cookie Cache**: Session store cookie cache now uses JWE by default for enhanced security.
* **OIDC RP-Initiated Logout**: Trigger logout at the OIDC provider.
* **Server-side IP Detection**: Automatic client IP detection utility.
* **Custom OTP Verification**: Allow custom logic for OTP verification in the Phone Number plugin.
* **Client `disableSignal`**: Option to disable default abort signal behavior in the client.
* **`AuthClient` Type Helper**: New type helper for better client-side type inference.
* **New Providers**: Polar and Paybin OAuth providers added.
* **ESM Only**: Better-Auth is now 100% ESM.
* **Session Refetching**: Support for polling & on-window-focus refetching.
* **Cloudflare Workers**: CLI support for virtual module imports.
* **Error Documentation**: Common OAuth flow errors are now [documented](https://www.better-auth.com/docs/errors.html).
* **Last-Login-Method**: Support for tracking SIWE & Passkey.

---

## [üêõ Bug fixes & Improvements](https://www.better-auth.com/blog/1-4.html#-bug-fixes--improvements)

This release includes over 250+ bug fixes addressing issues across all areas:

* **Adapter Fixes**: Improved query handling, better type transformations, UUID column types, and resolved issues with nullable foreign keys.
* **Session Management**: Fixed session refresh triggers, improved cookie handling, and better cache management.
* **OAuth**: Fixed state management, improved callback handling, and resolved cross-origin issues.
* **Organization**: Fixed member deletion, team management, permission checks, and inference issues.
* **Two-Factor**: Improved TOTP error messages, fixed backup code encryption, and better device trust handling.
* **Email OTP:** Prevented duplicate verification emails and improved session signal triggers.
* **SSO**: Fixed SAML callback handling, improved OIDC scope fallback, and better consent enforcement.
* **API-Keys**: Fixed usage tracking and improved request validation.
* **Phone Number**: Prevent unauthorized phone number updates and improved verification flow.
* And many more!

---

A lot of refinements to make everything smoother, faster, and more reliable.
üëâ [Check the full changelog](https://github.com/better-auth/better-auth/releases/tag/v1.4.0)

## [‚ù§Ô∏è Contributors](https://www.better-auth.com/blog/1-4.html#Ô∏è-contributors)

Thanks to all the contributors for making this release possible!

[Z](https://github.com/zain "@zain")[D](https://github.com/dandamian "@dandamian")[H](https://github.com/hartbit "@hartbit")[R](https://github.com/rmarscher "@rmarscher")[K](https://github.com/kaandok "@kaandok")[A](https://github.com/acusti "@acusti")[R](https://github.com/rbayliss "@rbayliss")[K](https://github.com/kevcube "@kevcube")[B](https://github.com/bsklaroff "@bsklaroff")[J](https://github.com/jonathansamines "@jonathansamines")[M](https://github.com/mburumaxwell "@mburumaxwell")[E](https://github.com/erquhart "@erquhart")[D](https://github.com/dmmulroy "@dmmulroy")[I](https://github.com/iRoachie "@iRoachie")[M](https://github.com/mohebifar "@mohebifar")[T](https://github.com/thomasmol "@thomasmol")[B](https://github.com/borgoat "@borgoat")[X](https://github.com/XiNiHa "@XiNiHa")[B](https://github.com/Berndwl "@Berndwl")[X](https://github.com/xiaoyu2er "@xiaoyu2er")[E](https://github.com/ebalo55 "@ebalo55")[U](https://github.com/udnes99 "@udnes99")[H](https://github.com/himself65 "@himself65")[D](https://github.com/dvanmali "@dvanmali")[A](https://github.com/AlexStrNik "@AlexStrNik")[T](https://github.com/ThibautCuchet "@ThibautCuchet")[Z](https://github.com/zbeyens "@zbeyens")[X](https://github.com/xuchenhao001 "@xuchenhao001")[T](https://github.com/tnkuehne "@tnkuehne")[T](https://github.com/Tobix99 "@Tobix99")[H](https://github.com/hieudien14310 "@hieudien14310")[3](https://github.com/3ddelano "@3ddelano")[B](https://github.com/bdkopen "@bdkopen")[J](https://github.com/jslno "@jslno")[C](https://github.com/chhoumann "@chhoumann")[M](https://github.com/mrl5 "@mrl5")[T](https://github.com/tgrassl "@tgrassl")[H](https://github.com/hyoban "@hyoban")[R](https://github.com/redoh "@redoh")[G](https://github.com/gregtjack "@gregtjack")[O](https://github.com/ouwargui "@ouwargui")[K](https://github.com/kanarian "@kanarian")[N](https://github.com/natetewelde "@natetewelde")[B](https://github.com/Badbird5907 "@Badbird5907")[M](https://github.com/max-programming "@max-programming")[E](https://github.com/eni4sure "@eni4sure")[F](https://github.com/frectonz "@frectonz")[E](https://github.com/ephraimduncan "@ephraimduncan")[E](https://github.com/Eazash "@Eazash")[A](https://github.com/ahmedriad1 "@ahmedriad1")[V](https://github.com/Velka-DEV "@Velka-DEV")[K](https://github.com/Kinfe123 "@Kinfe123")[Z](https://github.com/zy1p "@zy1p")[O](https://github.com/okisdev "@okisdev")[S](https://github.com/surafel58 "@surafel58")[D](https://github.com/DevDuki "@DevDuki")[T](https://github.com/TheUntraceable "@TheUntraceable")[N](https://github.com/nakasyou "@nakasyou")[J](https://github.com/JagritGumber "@JagritGumber")[H](https://github.com/HoshangDEV "@HoshangDEV")[V](https://github.com/vagxrth "@vagxrth")[P](https://github.com/Paola3stefania "@Paola3stefania")[B](https://github.com/Bekacru "@Bekacru")[K](https://github.com/kira-1011 "@kira-1011")[A](https://github.com/almadoro "@almadoro")[O](https://github.com/ocherry341 "@ocherry341")[Q](https://github.com/QuintenStr "@QuintenStr")[R](https://github.com/Ridhim-RR "@Ridhim-RR")[A](https://github.com/ahmed-abdat "@ahmed-abdat")[M](https://github.com/mohit4bug "@mohit4bug")[P](https://github.com/Pankaj3112 "@Pankaj3112")[S](https://github.com/ShobhitPatra "@ShobhitPatra")[P](https://github.com/ping-maxwell "@ping-maxwell")[N](https://github.com/nbifrye "@nbifrye")[R](https://github.com/rovertrack "@rovertrack")[G](https://github.com/GautamBytes "@GautamBytes")[A](https://github.com/AntonVishal "@AntonVishal")[B](https://github.com/bytaesu "@bytaesu")[I](https://github.com/ic4l4s9c "@ic4l4s9c")[J](https://github.com/jcajuab "@jcajuab")[Y](https://github.com/yutaka5 "@yutaka5")

---
