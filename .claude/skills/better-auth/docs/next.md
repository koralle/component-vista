---
title: "Next.js integration | Better Auth"
source_url: "https://www.better-auth.com/docs/integrations/next"
fetched_at: "2025-12-17T17:03:49.997163+00:00"
---



Docs

get started, concepts, and plugins

Search documentation...

Get Started

Loading...

Loading...

Loading...

Loading...

Concepts

Authentication

Databases

Integrations

Plugins

Guides

Reference

# Next.js integration

Copy MarkdownOpen in

Better Auth can be easily integrated with Next.js. Before you start, make sure you have a Better Auth instance configured. If you haven't done that yet, check out the [installation](https://www.better-auth.com/docs/installation.html).

### [Create API Route](https://www.better-auth.com/docs/integrations/next.html#create-api-route)

We need to mount the handler to an API route. Create a route file inside `/api/auth/[...all]` directory. And add the following code:

api/auth/[...all]/route.ts

```
import { auth } from "@/lib/auth";
import { toNextJsHandler } from "better-auth/next-js";

export const { GET, POST } = toNextJsHandler(auth);
```

You can change the path on your better-auth configuration but it's recommended to keep it as `/api/auth/[...all]`

For `pages` route, you need to use `toNodeHandler` instead of `toNextJsHandler` and set `bodyParser` to `false` in the `config` object. Here is an example:

pages/api/auth/[...all].ts

```
import { toNodeHandler } from "better-auth/node"
import { auth } from "@/lib/auth"

// Disallow body parsing, we will parse it manually
export const config = { api: { bodyParser: false } }

export default toNodeHandler(auth.handler)
```

## [Create a client](https://www.better-auth.com/docs/integrations/next.html#create-a-client)

Create a client instance. You can name the file anything you want. Here we are creating `client.ts` file inside the `lib/` directory.

auth-client.ts

```
import { createAuthClient } from "better-auth/react" // make sure to import from better-auth/react

export const authClient =  createAuthClient({
    //you can pass client configuration here
})
```

Once you have created the client, you can use it to sign up, sign in, and perform other actions.
Some of the actions are reactive. The client uses [nano-store](https://github.com/nanostores/nanostores) to store the state and re-render the components when the state changes.

The client also uses [better-fetch](https://github.com/bekacru/better-fetch) to make the requests. You can pass the fetch configuration to the client.

## [RSC and Server actions](https://www.better-auth.com/docs/integrations/next.html#rsc-and-server-actions)

The `api` object exported from the auth instance contains all the actions that you can perform on the server. Every endpoint made inside Better Auth is a invocable as a function. Including plugins endpoints.

**Example: Getting Session on a server action**

server.ts

```
import { auth } from "@/lib/auth"
import { headers } from "next/headers"

const someAuthenticatedAction = async () => {
    "use server";
    const session = await auth.api.getSession({
        headers: await headers()
    })
};
```

**Example: Getting Session on a RSC**

```
import { auth } from "@/lib/auth"
import { headers } from "next/headers"

export async function ServerComponent() {
    const session = await auth.api.getSession({
        headers: await headers()
    })
    if(!session) {
        return <div>Not authenticated</div>
    }
    return (
        <div>
            <h1>Welcome {session.user.name}</h1>
        </div>
    )
}
```

As RSCs cannot set cookies, the [cookie cache](https://www.better-auth.com/docs/concepts/session-management.html#cookie-cache) will not be refreshed until the server is interacted with from the client via Server Actions or Route Handlers.

### [Server Action Cookies](https://www.better-auth.com/docs/integrations/next.html#server-action-cookies)

When you call a function that needs to set cookies, like `signInEmail` or `signUpEmail` in a server action, cookies won’t be set. This is because server actions need to use the `cookies` helper from Next.js to set cookies.

To simplify this, you can use the `nextCookies` plugin, which will automatically set cookies for you whenever a `Set-Cookie` header is present in the response.

auth.ts

```
import { betterAuth } from "better-auth";
import { nextCookies } from "better-auth/next-js";

export const auth = betterAuth({
    //...your config
    plugins: [nextCookies()] // make sure this is the last plugin in the array
})
```

Now, when you call functions that set cookies, they will be automatically set.

```
"use server";
import { auth } from "@/lib/auth"

const signIn = async () => {
    await auth.api.signInEmail({
        body: {
            email: "user@email.com",
            password: "password",
        }
    })
}
```

## [Auth Protection](https://www.better-auth.com/docs/integrations/next.html#auth-protection)

In Next.js proxy/middleware, it's recommended to only check for the existence of a session cookie to handle redirection. To avoid blocking requests by making API or database calls.

### [Next.js 16+ (Proxy)](https://www.better-auth.com/docs/integrations/next.html#nextjs-16-proxy)

Next.js 16 replaces "middleware" with "proxy". You can use the Node.js runtime for full session validation with database checks:

proxy.ts

```
import { NextRequest, NextResponse } from "next/server";
import { headers } from "next/headers";
import { auth } from "@/lib/auth";

export async function proxy(request: NextRequest) {
    const session = await auth.api.getSession({
        headers: await headers()
    })

    // THIS IS NOT SECURE!
    // This is the recommended approach to optimistically redirect users
    // We recommend handling auth checks in each page/route
    if(!session) {
        return NextResponse.redirect(new URL("/sign-in", request.url));
    }

    return NextResponse.next();
}

export const config = {
  matcher: ["/dashboard"], // Specify the routes the middleware applies to
};
```

For cookie-only checks (faster but less secure), use `getSessionCookie`:

proxy.ts

```
import { NextRequest, NextResponse } from "next/server";
import { getSessionCookie } from "better-auth/cookies";

export async function proxy(request: NextRequest) {
	const sessionCookie = getSessionCookie(request);

    // THIS IS NOT SECURE!
    // This is the recommended approach to optimistically redirect users
    // We recommend handling auth checks in each page/route
	if (!sessionCookie) {
		return NextResponse.redirect(new URL("/", request.url));
	}

	return NextResponse.next();
}

export const config = {
	matcher: ["/dashboard"], // Specify the routes the middleware applies to
};
```

**Migration from middleware:** Rename `middleware.ts` → `proxy.ts` and `middleware` → `proxy` function. All Better Auth methods work identically.

### [Next.js 15.2.0+ (Node.js Runtime Middleware)](https://www.better-auth.com/docs/integrations/next.html#nextjs-1520-nodejs-runtime-middleware)

From Next.js 15.2.0, you can use the Node.js runtime in middleware for full session validation with database checks:

middleware.ts

```
import { NextRequest, NextResponse } from "next/server";
import { headers } from "next/headers";
import { auth } from "@/lib/auth";

export async function middleware(request: NextRequest) {
    const session = await auth.api.getSession({
        headers: await headers()
    })

    // THIS IS NOT SECURE!
    // This is the recommended approach to optimistically redirect users
    // We recommend handling auth checks in each page/route
    if(!session) {
        return NextResponse.redirect(new URL("/sign-in", request.url));
    }

    return NextResponse.next();
}

export const config = {
  runtime: "nodejs", // Required for auth.api calls
  matcher: ["/dashboard"], // Specify the routes the middleware applies to
};
```

Node.js runtime in middleware is experimental in Next.js versions before 16. Consider upgrading to Next.js 16+ for stable proxy support.

### [Next.js 13-15.1.x (Edge Runtime Middleware)](https://www.better-auth.com/docs/integrations/next.html#nextjs-13-151x-edge-runtime-middleware)

In older Next.js versions, middleware runs on the Edge Runtime and cannot make database calls. Use cookie-based checks for optimistic redirects:

The `getSessionCookie()` function does not automatically reference the auth config specified in `auth.ts`. Therefore, if you customized the cookie name or prefix, you need to ensure that the configuration in `getSessionCookie()` matches the config defined in your `auth.ts`.

#### [For Next.js release `15.1.7` and below](https://www.better-auth.com/docs/integrations/next.html#for-nextjs-release-1517-and-below)

If you need the full session object, you'll have to fetch it from the `/api/auth/get-session` API route. Since Next.js middleware doesn't support running Node.js APIs directly, you must make an HTTP request.

The example uses [better-fetch](https://better-fetch.vercel.app), but you can use any fetch library.

middleware.ts

```
import { betterFetch } from "@better-fetch/fetch";
import type { auth } from "@/lib/auth";
import { NextRequest, NextResponse } from "next/server";

type Session = typeof auth.$Infer.Session;

export async function middleware(request: NextRequest) {
	const { data: session } = await betterFetch<Session>("/api/auth/get-session", {
		baseURL: request.nextUrl.origin,
		headers: {
			cookie: request.headers.get("cookie") || "", // Forward the cookies from the request
		},
	});

	if (!session) {
		return NextResponse.redirect(new URL("/sign-in", request.url));
	}

	return NextResponse.next();
}

export const config = {
	matcher: ["/dashboard"], // Apply middleware to specific routes
};
```

#### [For Next.js release `15.2.0` and above](https://www.better-auth.com/docs/integrations/next.html#for-nextjs-release-1520-and-above)

From Next.js 15.2.0, you can use the Node.js runtime in middleware for full session validation with database checks:

You may refer to the [Next.js documentation](https://nextjs.org/docs/app/building-your-application/routing/middleware#runtime) for more information about runtime configuration, and how to enable it.
Be careful when using the new runtime. It's an experimental feature and it may be subject to breaking changes.

middleware.ts

```
import { NextRequest, NextResponse } from "next/server";
import { headers } from "next/headers";
import { auth } from "@/lib/auth";

export async function middleware(request: NextRequest) {
    const session = await auth.api.getSession({
        headers: await headers()
    })

    if(!session) {
        return NextResponse.redirect(new URL("/sign-in", request.url));
    }

    return NextResponse.next();
}

export const config = {
  runtime: "nodejs",
  matcher: ["/dashboard"], // Apply middleware to specific routes
};
```

#### [Cookie-based checks (recommended for all versions)](https://www.better-auth.com/docs/integrations/next.html#cookie-based-checks-recommended-for-all-versions)

middleware.ts

```
import { NextRequest, NextResponse } from "next/server";
import { getSessionCookie } from "better-auth/cookies";

export async function middleware(request: NextRequest) {
	const sessionCookie = getSessionCookie(request);

    // THIS IS NOT SECURE!
    // This is the recommended approach to optimistically redirect users
    // We recommend handling auth checks in each page/route
	if (!sessionCookie) {
		return NextResponse.redirect(new URL("/", request.url));
	}

	return NextResponse.next();
}

export const config = {
	matcher: ["/dashboard"], // Specify the routes the middleware applies to
};
```

**Security Warning:** The `getSessionCookie` function only checks for the
existence of a session cookie; it does **not** validate it. Relying solely
on this check for security is dangerous, as anyone can manually create a
cookie to bypass it. You must always validate the session on your server for
any protected actions or pages.

If you have a custom cookie name or prefix, you can pass it to the `getSessionCookie` function.

```
const sessionCookie = getSessionCookie(request, {
    cookieName: "my_session_cookie",
    cookiePrefix: "my_prefix"
});
```

Alternatively, you can use the `getCookieCache` helper to get the session object from the cookie cache.

middleware.ts

```
import { getCookieCache } from "better-auth/cookies";

export async function middleware(request: NextRequest) {
	const session = await getCookieCache(request);
	if (!session) {
		return NextResponse.redirect(new URL("/sign-in", request.url));
	}
	return NextResponse.next();
}
```

### [How to handle auth checks in each page/route](https://www.better-auth.com/docs/integrations/next.html#how-to-handle-auth-checks-in-each-pageroute)

In this example, we are using the `auth.api.getSession` function within a server component to get the session object,
then we are checking if the session is valid. If it's not, we are redirecting the user to the sign-in page.

app/dashboard/page.tsx

```
import { auth } from "@/lib/auth";
import { headers } from "next/headers";
import { redirect } from "next/navigation";

export default async function DashboardPage() {
    const session = await auth.api.getSession({
        headers: await headers()
    })

    if(!session) {
        redirect("/sign-in")
    }

    return <h1>Welcome {session.user.name}</h1>
}
```

## [Next.js 16 Compatibility](https://www.better-auth.com/docs/integrations/next.html#nextjs-16-compatibility)

Better Auth is fully compatible with Next.js 16. The main change is that "middleware" is now called "proxy". See the [Auth Protection](https://www.better-auth.com/docs/integrations/next.html#auth-protection) section above for Next.js 16+ proxy examples.

### [Migration Guide](https://www.better-auth.com/docs/integrations/next.html#migration-guide)

Use Next.js codemod for automatic migration:

```
npx @next/codemod@canary middleware-to-proxy .
```

Or manually:

* Rename `middleware.ts` → `proxy.ts`
* Change function name: `middleware` → `proxy`

All Better Auth methods work identically. See the [Next.js migration guide](https://nextjs.org/docs/app/api-reference/file-conventions/proxy#migration-to-proxy) for details.

[Edit on GitHub](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/integrations/next.mdx)

[Previous Page

Remix](https://www.better-auth.com/docs/integrations/remix.html)[Next Page

Nuxt](https://www.better-auth.com/docs/integrations/nuxt.html)

### On this page

[Create API Route](https://www.better-auth.com/docs/integrations/next.html#create-api-route)[Create a client](https://www.better-auth.com/docs/integrations/next.html#create-a-client)[RSC and Server actions](https://www.better-auth.com/docs/integrations/next.html#rsc-and-server-actions)[Server Action Cookies](https://www.better-auth.com/docs/integrations/next.html#server-action-cookies)[Auth Protection](https://www.better-auth.com/docs/integrations/next.html#auth-protection)[Next.js 16+ (Proxy)](https://www.better-auth.com/docs/integrations/next.html#nextjs-16-proxy)[Next.js 15.2.0+ (Node.js Runtime Middleware)](https://www.better-auth.com/docs/integrations/next.html#nextjs-1520-nodejs-runtime-middleware)[Next.js 13-15.1.x (Edge Runtime Middleware)](https://www.better-auth.com/docs/integrations/next.html#nextjs-13-151x-edge-runtime-middleware)[For Next.js release `15.1.7` and below](https://www.better-auth.com/docs/integrations/next.html#for-nextjs-release-1517-and-below)[For Next.js release `15.2.0` and above](https://www.better-auth.com/docs/integrations/next.html#for-nextjs-release-1520-and-above)[Cookie-based checks (recommended for all versions)](https://www.better-auth.com/docs/integrations/next.html#cookie-based-checks-recommended-for-all-versions)[How to handle auth checks in each page/route](https://www.better-auth.com/docs/integrations/next.html#how-to-handle-auth-checks-in-each-pageroute)[Next.js 16 Compatibility](https://www.better-auth.com/docs/integrations/next.html#nextjs-16-compatibility)[Migration Guide](https://www.better-auth.com/docs/integrations/next.html#migration-guide)

Ask AI
