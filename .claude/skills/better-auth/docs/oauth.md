---
title: "OAuth | Better Auth"
source_url: "https://www.better-auth.com/docs/concepts/oauth"
fetched_at: "2025-12-17T17:03:49.997163+00:00"
---



Docs

get started, concepts, and plugins

Search documentation...

Get Started

Loading...

Loading...

Loading...

Loading...

Concepts

Authentication

Databases

Integrations

Plugins

Guides

Reference

# OAuth

Copy MarkdownOpen in

Better Auth comes with built-in support for OAuth 2.0 and OpenID Connect. This allows you to authenticate users via popular OAuth providers like Google, Facebook, GitHub, and more.

If your desired provider isn't directly supported, you can use the [Generic OAuth Plugin](https://www.better-auth.com/docs/plugins/generic-oauth.html) for custom integrations.

## [Configuring Social Providers](https://www.better-auth.com/docs/concepts/oauth.html#configuring-social-providers)

To enable a social provider, you need to provide `clientId` and `clientSecret` for the provider.

Here's an example of how to configure Google as a provider:

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
    },
  },
});
```

## [Usage](https://www.better-auth.com/docs/concepts/oauth.html#usage)

### [Sign In](https://www.better-auth.com/docs/concepts/oauth.html#sign-in)

To sign in with a social provider, you can use the `signIn.social` function with the `authClient` or `auth.api` for server-side usage.

```
// client-side usage
await authClient.signIn.social({
  provider: "google", // or any other provider id
})
```

```
// server-side usage
await auth.api.signInSocial({
  body: {
    provider: "google", // or any other provider id
  },
});
```

### [Link account](https://www.better-auth.com/docs/concepts/oauth.html#link-account)

To link an account to a social provider, you can use the `linkAccount` function with the `authClient` or `auth.api` for server-side usage.

```
await authClient.linkSocial({
  provider: "google", // or any other provider id
})
```

server-side usage:

```
await auth.api.linkSocialAccount({
  body: {
    provider: "google", // or any other provider id
  },
  headers: // pass headers with authenticated token
});
```

### [Get Access Token](https://www.better-auth.com/docs/concepts/oauth.html#get-access-token)

To get the access token for a social provider, you can use the `getAccessToken` function with the `authClient` or `auth.api` for server-side usage. When you use this endpoint, if the access token is expired, it will be refreshed.

```
const { accessToken } = await authClient.getAccessToken({
  providerId: "google", // or any other provider id
  accountId: "accountId", // optional, if you want to get the access token for a specific account
})
```

server-side usage:

```
await auth.api.getAccessToken({
  body: {
    providerId: "google", // or any other provider id
    accountId: "accountId", // optional, if you want to get the access token for a specific account
    userId: "userId", // optional, if you don't provide headers with authenticated token
  },
  headers: // pass headers with authenticated token
});
```

### [Get Account Info Provided by the provider](https://www.better-auth.com/docs/concepts/oauth.html#get-account-info-provided-by-the-provider)

To get provider specific account info you can use the `accountInfo` function with the `authClient` or `auth.api` for server-side usage.

```
const info = await authClient.accountInfo({
  accountId: "accountId", // here you pass in the provider given account id, the provider is automatically detected from the account id
})
```

server-side usage:

```
await auth.api.accountInfo({
  query: { accountId: "accountId" },
  headers: // pass headers with authenticated token
});
```

### [Requesting Additional Scopes](https://www.better-auth.com/docs/concepts/oauth.html#requesting-additional-scopes)

Sometimes your application may need additional OAuth scopes after the user has already signed up (e.g., for accessing GitHub repositories or Google Drive). Users may not want to grant extensive permissions initially, preferring to start with minimal permissions and grant additional access as needed.

You can request additional scopes by using the `linkSocial` method with the same provider. This will trigger a new OAuth flow that requests the additional scopes while maintaining the existing account connection.

```
const requestAdditionalScopes = async () => {
    await authClient.linkSocial({
        provider: "google",
        scopes: ["https://www.googleapis.com/auth/drive.file"],
    });
};
```

Make sure you're running Better Auth version 1.2.7 or later. Earlier versions (like 1.2.2) may show a "Social account already linked" error when trying to link with an existing provider for additional scopes.

### [Passing Additional Data Through OAuth Flow](https://www.better-auth.com/docs/concepts/oauth.html#passing-additional-data-through-oauth-flow)

Better Auth allows you to pass additional data through the OAuth flow without storing it in the database. This is useful for scenarios like tracking referral codes, analytics sources, or other temporary data that should be processed during authentication but not persisted.

When initiating OAuth sign-in or account linking, pass the additional data:

```
// Client-side: Sign in with additional data
await authClient.signIn.social({
  provider: "google",
  additionalData: {
    referralCode: "ABC123",
    source: "landing-page",
  },
});

// Client-side: Link account with additional data
await authClient.linkSocial({
  provider: "google",
  additionalData: {
    referralCode: "ABC123",
  },
});

// Server-side: Sign in with additional data
await auth.api.signInSocial({
  body: {
    provider: "google",
    additionalData: {
      referralCode: "ABC123",
      source: "admin-panel",
    },
  },
});
```

#### [Accessing Additional Data in Hooks](https://www.better-auth.com/docs/concepts/oauth.html#accessing-additional-data-in-hooks)

The additional data is available in your hooks during the OAuth callback through the `getOAuthState`.

This usually works for `/callback/:id` paths and the generic OAuth plugin callback path (`/oauth2/callback/:providerId`).

Example using a before hook:

auth.ts

```
import { betterAuth } from "better-auth";
import { getOAuthState } from "better-auth/api";

export const auth = betterAuth({
  // Other configurations...
  hooks: {
    after: [
      {
        matcher: () => true,
        handler: async (ctx) => {
          // Additional data is only available during OAuth callback
          if (ctx.path === "/callback/:id") {
            const additionalData = await getOAuthState<{
              referralCode?: string;
              source?: string;
            }>();

            if (additionalData) {
              // IMPORTANT: Validate and sanitize the data before using it
              // This data comes from the client and should not be trusted

              // Example: Validate and process referral code
              if (additionalData.referralCode) {
                const isValidFormat = /^[A-Z0-9]{6}$/.test(additionalData.referralCode);
                if (isValidFormat) {
                  // Verify the referral code exists in your database
                  const referral = await db.referrals.findByCode(additionalData.referralCode);
                  if (referral) {
                    // Safe to use the verified referral
                    await db.referrals.incrementUsage(referral.id);
                  }
                }
              }

              // Track analytics (low-risk usage)
              if (additionalData.source) {
                await analytics.track("oauth_signin", {
                  source: additionalData.source,
                  userId: ctx.context.session?.user.id,
                });
              }
            }
          }
        },
      },
    ],
  },
});
```

Example using a database hook:

auth.ts

```
 // You can also access additional data in database hooks
  databaseHooks: {
    user: {
      create: {
        before: async (user, ctx) => {
          if (ctx.path === "/callback/:id") {
            const additionalData = await getOAuthState<{ referredFrom?: string }>();
            if (additionalData?.referredFrom) {
              return {
                data: {
                  referredFrom: additionalData.referredFrom,
                },
              };
            }
          }
        },
      },
    },
  },
```

By default OAuth state includes the following data:

* `callbackURL` - the callback URL for the OAuth flow
* `codeVerifier` - the code verifier for the OAuth flow
* `errorURL` - the error URL for the OAuth flow
* `newUserURL` - the new user URL for the OAuth flow
* `link` - the link for the OAuth flow (email and user id)
* `requestSignUp` - whether to request sign up for the OAuth flow
* `expiresAt` - the expiration time of the OAuth state
* `[key: string]`: any additional data you pass in the OAuth flow

## [Provider Options](https://www.better-auth.com/docs/concepts/oauth.html#provider-options)

### [scope](https://www.better-auth.com/docs/concepts/oauth.html#scope)

The scope of the access request. For example, `email` or `profile`.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      scope: ["email", "profile"],
    },
  },
});
```

### [redirectURI](https://www.better-auth.com/docs/concepts/oauth.html#redirecturi)

Custom redirect URI for the provider. By default, it uses `/api/auth/callback/${providerName}`

auth.ts

```
export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      redirectURI: "https://your-app.com/auth/callback",
    },
  },
});
```

### [disableSignUp](https://www.better-auth.com/docs/concepts/oauth.html#disablesignup)

Disables sign-up for new users.

### [disableIdTokenSignIn](https://www.better-auth.com/docs/concepts/oauth.html#disableidtokensignin)

Disables the use of the ID token for sign-in. By default, it's enabled for some providers like Google and Apple.

### [verifyIdToken](https://www.better-auth.com/docs/concepts/oauth.html#verifyidtoken)

A custom function to verify the ID token.

### [overrideUserInfoOnSignIn](https://www.better-auth.com/docs/concepts/oauth.html#overrideuserinfoonsignin)

A boolean value that determines whether to override the user information in the database when signing in. By default, it is set to `false`, meaning that the user information will not be overridden during sign-in. If you want to update the user information every time they sign in, set this to `true`.

### [mapProfileToUser](https://www.better-auth.com/docs/concepts/oauth.html#mapprofiletouser)

A custom function to map the user profile returned from the provider to the user object in your database.

Useful, if you have additional fields in your user object you want to populate from the provider's profile. Or if you want to change how by default the user object is mapped.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      mapProfileToUser: (profile) => {
        return {
          firstName: profile.given_name,
          lastName: profile.family_name,
        };
      },
    },
  },
});
```

### [refreshAccessToken](https://www.better-auth.com/docs/concepts/oauth.html#refreshaccesstoken)

A custom function to refresh the token. This feature is only supported for built-in social providers (Google, Facebook, GitHub, etc.) and is not currently supported for custom OAuth providers configured through the Generic OAuth Plugin. For built-in providers, you can provide a custom function to refresh the token if needed.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      refreshAccessToken: async (token) => {
        return {
          accessToken: "new-access-token",
          refreshToken: "new-refresh-token",
        };
      },
    },
  },
});
```

### [clientKey](https://www.better-auth.com/docs/concepts/oauth.html#clientkey)

The client key of your application. This is used by TikTok Social Provider instead of `clientId`.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    tiktok: {
      clientKey: "YOUR_TIKTOK_CLIENT_KEY",
      clientSecret: "YOUR_TIKTOK_CLIENT_SECRET",
    },
  },
});
```

### [getUserInfo](https://www.better-auth.com/docs/concepts/oauth.html#getuserinfo)

A custom function to get user info from the provider. This allows you to override the default user info retrieval process.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      getUserInfo: async (token) => {
        // Custom implementation to get user info
        const response = await fetch("https://www.googleapis.com/oauth2/v2/userinfo", {
          headers: {
            Authorization: `Bearer ${token.accessToken}`,
          },
        });
        const profile = await response.json();
        return {
          user: {
            id: profile.id,
            name: profile.name,
            email: profile.email,
            image: profile.picture,
            emailVerified: profile.verified_email,
          },
          data: profile,
        };
      },
    },
  },
});
```

### [disableImplicitSignUp](https://www.better-auth.com/docs/concepts/oauth.html#disableimplicitsignup)

Disables implicit sign up for new users. When set to true for the provider, sign-in needs to be called with `requestSignUp` as true to create new users.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      disableImplicitSignUp: true,
    },
  },
});
```

### [prompt](https://www.better-auth.com/docs/concepts/oauth.html#prompt)

The prompt to use for the authorization code request. This controls the authentication flow behavior.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      prompt: "select_account", // or "consent", "login", "none", "select_account+consent"
    },
  },
});
```

### [responseMode](https://www.better-auth.com/docs/concepts/oauth.html#responsemode)

The response mode to use for the authorization code request. This determines how the authorization response is returned.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      responseMode: "query", // or "form_post"
    },
  },
});
```

### [disableDefaultScope](https://www.better-auth.com/docs/concepts/oauth.html#disabledefaultscope)

Removes the default scopes of the provider. By default, providers include certain scopes like `email` and `profile`. Set this to `true` to remove these default scopes and use only the scopes you specify.

auth.ts

```
import { betterAuth } from "better-auth";

export const auth = betterAuth({
  // Other configurations...
  socialProviders: {
    google: {
      clientId: "YOUR_GOOGLE_CLIENT_ID",
      clientSecret: "YOUR_GOOGLE_CLIENT_SECRET",
      disableDefaultScope: true,
      scope: ["https://www.googleapis.com/auth/userinfo.email"], // Only this scope will be used
    },
  },
});
```

### [Other Provider Configurations](https://www.better-auth.com/docs/concepts/oauth.html#other-provider-configurations)

Each provider may have additional options, check the specific provider documentation for more details.

[Edit on GitHub](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/concepts/oauth.mdx)

[Previous Page

Plugins](https://www.better-auth.com/docs/concepts/plugins.html)[Next Page

Rate Limit](https://www.better-auth.com/docs/concepts/rate-limit.html)

### On this page

[Configuring Social Providers](https://www.better-auth.com/docs/concepts/oauth.html#configuring-social-providers)[Usage](https://www.better-auth.com/docs/concepts/oauth.html#usage)[Sign In](https://www.better-auth.com/docs/concepts/oauth.html#sign-in)[Link account](https://www.better-auth.com/docs/concepts/oauth.html#link-account)[Get Access Token](https://www.better-auth.com/docs/concepts/oauth.html#get-access-token)[Get Account Info Provided by the provider](https://www.better-auth.com/docs/concepts/oauth.html#get-account-info-provided-by-the-provider)[Requesting Additional Scopes](https://www.better-auth.com/docs/concepts/oauth.html#requesting-additional-scopes)[Passing Additional Data Through OAuth Flow](https://www.better-auth.com/docs/concepts/oauth.html#passing-additional-data-through-oauth-flow)[Accessing Additional Data in Hooks](https://www.better-auth.com/docs/concepts/oauth.html#accessing-additional-data-in-hooks)[Provider Options](https://www.better-auth.com/docs/concepts/oauth.html#provider-options)[scope](https://www.better-auth.com/docs/concepts/oauth.html#scope)[redirectURI](https://www.better-auth.com/docs/concepts/oauth.html#redirecturi)[disableSignUp](https://www.better-auth.com/docs/concepts/oauth.html#disablesignup)[disableIdTokenSignIn](https://www.better-auth.com/docs/concepts/oauth.html#disableidtokensignin)[verifyIdToken](https://www.better-auth.com/docs/concepts/oauth.html#verifyidtoken)[overrideUserInfoOnSignIn](https://www.better-auth.com/docs/concepts/oauth.html#overrideuserinfoonsignin)[mapProfileToUser](https://www.better-auth.com/docs/concepts/oauth.html#mapprofiletouser)[refreshAccessToken](https://www.better-auth.com/docs/concepts/oauth.html#refreshaccesstoken)[clientKey](https://www.better-auth.com/docs/concepts/oauth.html#clientkey)[getUserInfo](https://www.better-auth.com/docs/concepts/oauth.html#getuserinfo)[disableImplicitSignUp](https://www.better-auth.com/docs/concepts/oauth.html#disableimplicitsignup)[prompt](https://www.better-auth.com/docs/concepts/oauth.html#prompt)[responseMode](https://www.better-auth.com/docs/concepts/oauth.html#responsemode)[disableDefaultScope](https://www.better-auth.com/docs/concepts/oauth.html#disabledefaultscope)[Other Provider Configurations](https://www.better-auth.com/docs/concepts/oauth.html#other-provider-configurations)

Ask AI
